<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="./index.css">
</head>
<body>
  hello
  <img src="./img1.jpeg" alt="">
  <img src="./img2.jpeg" alt="">
  <img src="./img3.jpeg" alt="">
  <img src="./img4.jpeg" alt="">
  <script>
    function ajax( options ){
      options = options || {};
      options.type = (options.type || 'GET').toUpperCase();
      options.dataType = options.dataType || 'json';
      var params = options.data ? formatData( options.data ) : '';

      var xmlhttp = new XMLHttpRequest();
      xmlhttp.onreadystatechange = function(){
          if( xmlhttp.readyState == 4){
              if( xmlhttp.status >= 200 && xmlhttp.status <= 300 ){
                  options.success && options.success( JSON.parse(xmlhttp.responseText) );
              }else{
                  options.fail && options.fail(status);options.fail();
              }
          }
      }


      if( options.type == 'POST' ){
          xmlhttp.open( options.type, options.url, true);
          //设置表单提交时的内容类型
          xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xmlhttp.send( params );
      }else{
          let url = options.url;
          if( params ){
            url = options.url+'?'+params;
          }
          xmlhttp.open( options.type, url, true);
          xmlhttp.send();
      }
  }

    // { a:1, b:2 } 转换成 a=1&b=2
    function formatData( data ){
        var arr = [];
        for( var name in data ){
            arr.push( encodeURIComponent( name ) + '=' + encodeURIComponent( data[name] ))
        }
        arr.push( ('v=' + Math.random()).replace('.','') );
        return arr.join('&');
    }

    ajax({
            url: "http://localhost:8111/a.json",              //请求地址
            type: "GET",                       //请求方式
            dataType: "json",
            success: function (response, xml) {
                // 此处放成功后执行的代码
                console.log( response );
            },
            fail: function (status) {
                // 此处放失败后执行的代码
            }
    });
  </script>
</body>
</html>